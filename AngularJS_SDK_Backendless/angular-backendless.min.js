(function(){function isEmpty(e){if(e==null)return true;if(angular.isArray(e)||angular.isString(e))return e.length===0;for(var t in e){if(e.hasOwnProperty(t)&&e[t]!==undefined&&e[t]!==null){return false}}return true}function isLocalStorageSupported(){try{if(isBrowser()&&"localStorage"in window&&window["localStorage"]){localStorage.setItem("localStorageTest",true);localStorage.removeItem("localStorageTest");return true}else{return false}}catch(e){return false}}function initXHR(){try{if(typeof XMLHttpRequest.prototype.sendAsBinary=="undefined"){XMLHttpRequest.prototype.sendAsBinary=function(e){var t=new ArrayBuffer(e.length);var n=new Uint8Array(t,0);for(var r=0;r<e.length;r++)n[r]=e.charCodeAt(r)&255;this.send(n)}}}catch(e){}}function isBrowser(){return typeof window!=="undefined"}var BackendlessAngular=angular.module("Backendless",[]);if(isLocalStorageSupported()){if(!localStorage["Backendless"]){localStorage["Backendless"]=JSON.stringify({})}}BackendlessAngular.config(function(e){delete e.defaults.headers.common["X-Requested-With"];e.defaults.transformResponse.push(function(e){try{return JSON.parse(e)}catch(t){return e}})});var UIState=null;var getNow=function(){return(new Date).getTime()};var getClassName=function(){var e=angular.isFunction(this)?this.toString():this.constructor.toString(),t=e.match(/function\s+(\w+)/);return t&&t.length>1?t[1]:""};var encodeArrayToUriComponent=function(e){var t=[],n,r;for(n=0,r=e.length;n<r;++n){t.push(encodeURIComponent(e[n]))}return t.join(",")};var classWrapper=function(obj){var wrapper=function(obj){var wrapperName=null,wrapperFunc=null;for(var property in obj){if(obj.hasOwnProperty(property)){if(property==="___class"){wrapperName=obj[property];break}}}if(wrapperName){try{wrapperFunc=eval(wrapperName);obj=deepExtend(new wrapperFunc,obj)}catch(e){}}return obj};if(angular.isObject(obj)&&obj!=null){if(angular.isArray(obj)){for(var i=obj.length;i--;){obj[i]=wrapper(obj[i])}}else{obj=wrapper(obj)}}return obj};var deepExtend=function(e,t){for(var n in t){if(t[n]!==undefined&&t.hasOwnProperty(n)){e[n]=e[n]||{};e[n]=classWrapper(t[n])}}return e};var emptyFn=function(){};BackendlessAngular.value("$config",{serverURL:"https://api.backendless.com",appId:null,secretKey:null,appVersion:null,appPath:null});BackendlessAngular.value("currentUser",null);BackendlessAngular.factory("$initApp",function(e,t){t=null;return function(t,n,r){this.serverURL=e.serverURL;this.secretKey=e.secretKey=n;this.appId=e.appId=t;this.appVersion=e.appVersion=r;this.appPath=e.appPath=[e.serverURL,e.appVersion].join("/")}});BackendlessAngular.factory("User",function(){return function(t,n){this.___class="Users";this.email=t;this.password=n}});BackendlessAngular.factory("$UserService",function(e,t,n,r,i){function s(){}s.prototype={login:function(r,s,o){var u=n.defer(),a={login:r,password:s},f=this,l=JSON.parse(localStorage["Backendless"]);l["stayLoggedIn"]=false;if(o){l["stayLoggedIn"]=true;localStorage.setItem("Backendless",JSON.stringify(l))}var c={"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"};if(i!=null&&i["user-token"]){c["user-token"]=i["user-token"]}else if(l["user-token"]){c["user-token"]=l["user-token"]}t.post(e.appPath+"/users/login",a,{headers:c}).success(function(e){i=f._getUserFromResponse(e);u.resolve(i)}).error(function(e){u.resolve(e)});return u.promise},isValidLogin:function(){var r="",i="",s=this,o=JSON.parse(localStorage["Backendless"]);console.info(o);if(o["user-token"]){r=o["user-token"];var u=n.defer();t.get(e.appPath+"/users/isvalidusertoken/"+r,{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json","user-token":r}}).success(function(e){u.resolve(e)}).error(function(e){u.resolve(e)});return u.promise}else{i=s.getCurrentUser();return i?true:false}},register:function(i){var s=n.defer(),o=this;if(!(i instanceof r)){throw new Error("Only Backendless.User accepted")}t.post(e.appPath+"/users/register",i,{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(o._getUserFromResponse(e))}).error(function(e){s.resolve(e)});return s.promise},getUserRoles:function(){var r=n.defer();t.get(e.appPath+"/users/userroles",{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){r.resolve(e)}).error(function(e){r.resolve(e)});return r.promise},roleHelper:function(r,i,s){if(!r){throw new Error("Username can not be empty")}if(!i){throw new Error("Rolename can not be empty")}var o=n.defer();var u={user:r,roleName:i};t.post(e.appPath+"/users/"+s,u,{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){o.resolve(e)}).error(function(e){o.resolve(e)});return o.promise},assignRole:function(e,t){return this.roleHelper(e,t,"assignRole")},unassignRole:function(e,t){return this.roleHelper(e,t,"unassignRole")},_getUserFromResponse:function(e){var t=new r,n=JSON.parse(localStorage["Backendless"]);for(var i in e){if(e.hasOwnProperty(i)){if(i=="user-token"){if(n["stayLoggedIn"]){n["user-token"]=e[i];localStorage.setItem("Backendless",JSON.stringify(n))}continue}t[i]=e[i]}}return t},getCurrentUser:function(){return i?this._getUserFromResponse(i):null},update:function(i){var s=n.defer(),o=this;if(!(i instanceof r)){throw new Error("Only Backendless.User accepted")}t.put(e.appPath+"/users/"+i.objectId,i,{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(o._getUserFromResponse(e))}).error(function(e){s.resolve(e)});return s.promise},logout:function(){function s(){i=null;var e=JSON.parse(localStorage["Backendless"]);delete e["user-token"];delete e["stayLoggedIn"];localStorage["Backendless"]=JSON.stringify(e)}var r=n.defer();t.get(e.appPath+"/users/logout",{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(){s();r.resolve(true)}).error(function(e){if(typeof e=="object"&&[3064,3091,3090,3023].indexOf(e.code)!=-1){s();r.resolve(true)}else{r.resolve(e)}});return r.promise},describeUserClass:function(){var r=n.defer();t.get(e.appPath+"/users/userclassprops",{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){r.resolve(e)}).error(function(e){r.resolve(e)});return r.promise},restorePassword:function(r){if(!r){throw"Username can not be empty"}var i=n.defer();t.get(e.appPath+"/users/restorepassword/"+r,{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){i.resolve(true)}).error(function(e){i.resolve(e)});return i.promise},loginWithFacebook:function(e,t,n,r){this._loginSocial("Facebook",e,t,n,r)},loginWithTwitter:function(e,t){this._loginSocial("Twitter",e,null,t,null)},_socialContainer:function(e,t){var n;if(t){var r;t=t[0];n=document.createElement("div");n.innerHTML="Loading...";t.appendChild(n);t.style.cursor="wait";this.closeContainer=function(){t.style.cursor="default";t.removeChild(r)};this.removeLoading=function(){t.removeChild(n)};this.doAuthorizationActivity=function(e){this.removeLoading();r=document.createElement("iframe");r.frameBorder=0;r.width=t.style.width;r.height=t.style.height;r.id="SocialAuthFrame";r.setAttribute("src",e+"&output=embed");t.appendChild(r);r.onload=function(){t.style.cursor="default"}}}else{t=window.open("",e+" authorization","height=250,width=450,scrollbars=0,toolbar=0,menubar=0,location=0,resizable=0,status=0,titlebar=0",false);n=t.document.getElementsByTagName("body")[0].innerHTML;n="Loading...";t.document.getElementsByTagName("html")[0].style.cursor="wait";this.closeContainer=function(){t.close()};this.removeLoading=function(){n=null};this.doAuthorizationActivity=function(e){t.location.href=e;t.onload=function(){t.document.getElementsByTagName("html")[0].style.cursor="default"}}}},_loginSocial:function(r,s,o,u,a){var f=new this._socialContainer(r,a);var l=s||o?{}:null;if(s)l.fieldsMapping=s;if(o)l.permissions=o;var c=n.defer();t.post(e.appPath+"/social/oauth/"+r.toLowerCase()+"/request_url",l,{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){i=e;c.resolve(e)}).error(function(e){c.resolve(e)});return c.promise},loginWithFacebookSdk:function(e){if(!FB)throw new Error("Facebook SDK not found");var t=this;FB.getLoginStatus(function(n){if(n.status==="connected")t._sendFacebookLoginRequest(t,n,e);else FB.login(function(n){t._sendFacebookLoginRequest(t,n,e)})})},_sendFacebookLoginRequest:function(r,s,o){if(s.status==="connected"){var u=s.authResponse;if(o)u["fieldsMapping"]=o;var a=n.defer();t.post(e.appPath+"/social/facebook/login/"+e.appId,u,{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){i=e;a.resolve(e)}).error(function(e){a.resolve(e)});return a.promise}}};return new s});BackendlessAngular.factory("$Persistence",function(e,t,n){function r(e){this.model=e;this.className=getClassName.call(e);if((typeof e).toLowerCase()==="string")this.className=e;if(!this.className){throw"Class name should be specified"}}r.prototype={_extendCollection:function(e,t){if(e.nextPage&&e.nextPage.split("/")[1]==n.appVersion){e.nextPage=n.serverURL+e.nextPage}e._nextPage=e.nextPage;e.nextPage=function(){return t._load(this._nextPage)};e.getPage=function(e,n){var r=this._nextPage.replace(/offset=\d+/ig,"offset="+e);r=r.replace(/pagesize=\d+/ig,"pageSize="+n);return t._load(r)};e.dataMapper=t},_parseResponse:function(e){var t,n,r=this.model,i;if(e.data){var s=e,o=s.data;for(t=0,n=o.length;t<n;++t){o[t]=o[t].fields||o[t];i=new r;deepExtend(i,o[t]);o[t]=i}this._extendCollection(s,this);return s}else{e=e.fields||e;i=new r;deepExtend(i,e);return this._formCircDeps(i)}},_extractQueryOptions:function(e){var t=[];if(typeof e.pageSize!="undefined"){if(e.pageSize<1||e.pageSize>100){throw new Error("PageSize can not be less then 1 or greater than 100")}t.push("pageSize="+encodeURIComponent(e.pageSize))}if(e.offset){if(e.offset<0){throw new Error("Offset can not be less then 0")}t.push("offset="+encodeURIComponent(e.offset))}if(e.sortBy){if(angular.isString(e.sortBy)){t.push("sortBy="+encodeURIComponent(e.sortBy))}else if(angular.isArray(e.sortBy)){t.push("sortBy="+encodeArrayToUriComponent(e.sortBy))}}if(e.relationsDepth){if(angular.isNumber(e.relationsDepth)){t.push("relationsDepth="+encodeURIComponent(Math.floor(e.relationsDepth)))}}if(e.relations){if(angular.isArray(e.relations)){t.push("loadRelations="+(e.relations.length?encodeArrayToUriComponent(e.relations):"*"))}}return t.join("&")},_load:function(r){var i=e.defer(),s=this;t.get("https://api.backendless.com/v1/data/Order?pageSize=10&offset=10",{headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){var t=s._parseResponse(e);i.resolve(t)}).error(function(e){i.resolve(e)});return i.promise},_replCircDeps:function(e){var t=[e],n,r=function(){for(var e="",t=e;t++<36;e+=t*51&&52?(t^15?8^Math.random()*(t^20?16:4):4).toString(16):"-"){}return e},i=function(e){for(var s in e){if(e.hasOwnProperty(s)&&typeof e[s]=="object"&&e[s]!=null){if((n=t.indexOf(e[s]))!=-1){t[n]["__subID"]=t[n]["__subID"]||r();e[s]={__originSubID:t[n]["__subID"]}}else{t.push(e[s]);i(e[s])}}}};i(e)},_formCircDeps:function(e){var t={},n=new e.constructor,r=function(e,n){if(e.hasOwnProperty("__subID")){t[e["__subID"]]=n;delete e["__subID"]}for(var i in e){if(e.hasOwnProperty(i)){if(typeof e[i]=="object"&&e[i]!=null){if(e[i].hasOwnProperty("__originSubID")){n[i]=t[e[i]["__originSubID"]]}else{n[i]=new e[i].constructor;r(e[i],n[i])}}else{n[i]=e[i]}}}};r(e,n);return n},save:function(r){this._replCircDeps(r);var i="POST",s=n.appPath+"/data/"+this.className,o=r;if(r.objectId){i="PUT";s+="/"+r.objectId}var u=e.defer();t({method:i.toLowerCase(),url:s,data:r,headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){u.resolve(deepExtend(o,e))}).error(function(e){u.resolve(e)});return u.promise},remove:function(r){var r=r.objectId||r,i=e.defer(),s=n.appPath+"/data/"+this.className+"/"+r;t({method:"delete",url:s,headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){i.resolve(e)}).error(function(e){i.resolve(e)});return i.promise},find:function(r){r=r||{};var i,s,o,u=[],a=n.appPath+"/data/"+this.className,f=this;if(r.properties){i="props="+encodeArrayToUriComponent(r.properties)}if(r.condition){s="where="+encodeURIComponent(r.condition)}if(r.options){o=this._extractQueryOptions(r.options)}o&&u.push(o);s&&u.push(s);i&&u.push(i);u=u.join("&");if(r.url){a+="/"+r.url}if(u){a+="?"+u}var l=e.defer();t({method:"get",url:a,headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){var t=f._parseResponse(e);l.resolve(t)}).error(function(e){l.resolve(e)});return l.promise},_buildArgsObject:function(){var e={},t=arguments.length,n="";for(;t--;){n=Object.prototype.toString.call(arguments[t]).toLowerCase().match(/[a-z]+/g)[1];switch(n){case"number":e.options=e.options||{};e.options.relationsDepth=arguments[t];break;case"string":e.url=arguments[t];break;case"array":e.options=e.options||{};e.options.relations=arguments[t];break;case"object":if(arguments[t].hasOwnProperty("cachePolicy")){e.cachePolicy=arguments[t]["cachePolicy"]}break;default:break}}return e},findById:function(){var e=this._buildArgsObject.apply(this,arguments);if(!e.url){throw new Error('missing argument "object ID" for method findById()')}return this.find.apply(this,[e].concat(Array.prototype.slice.call(arguments)))},loadRelations:function(e){if(!(e&&e.objectId)){throw new Error("missing object argument for method loadRelations()")}var t=this._buildArgsObject.apply(this,arguments);t.url=e.objectId;deepExtend(e,this.find.apply(this,[t].concat(Array.prototype.slice.call(arguments))))},findFirst:function(){var e=this._buildArgsObject.apply(this,arguments);e.url="first";return this.find.apply(this,[e].concat(Array.prototype.slice.call(arguments)))},findLast:function(){var e=this._buildArgsObject.apply(this,arguments);e.url="last";return this.find.apply(this,[e].concat(Array.prototype.slice.call(arguments)))}};var i={};return{save:function(i,s){if(angular.isString(i)){var o=n.appPath+"/data/"+i,u=e.defer();t.post(o,s,{headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){u.resolve(e)}).error(function(e){u.resolve(e)});return u.promise}if(angular.isObject(i)){return(new r(i)).save(i,s)}},of:function(e){var t=getClassName.call(e);var n=i[t];if(!n){n=new r(e);i[t]=n}return n},describe:function(r){r=angular.isString(r)?r:getClassName.call(r);var i=n.appPath+"/data/"+r+"/properties",s=e.defer();t.get(i,{headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(e)}).error(function(e){s.resolve(e)});return s.promise}}});BackendlessAngular.factory("$GeoQuery",function(){function e(){this.searchRectangle=null;this.categories=[];this.includeMeta=false;this.pageSize=10;this.latitude=0;this.longitude=0;this.radius=0;this.units=null}e.prototype={addCategory:function(){this.categories=this.categories||[];this.categories.push()}};return new e});BackendlessAngular.factory("$Geo",function(e,t,n){function r(){}r.prototype={UNITS:{METERS:"METERS",KILOMETERS:"KILOMETERS",MILES:"MILES",YARDS:"YARDS",FEET:"FEET"},_findHelpers:{searchRectangle:function(e){var t=["nwlat="+e[0],"nwlon="+e[1],"selat="+e[2],"selon="+e[3]];return t.join("&")},latitude:function(e){return"lat="+e},longitude:function(e){return"lon="+e},metadata:function(e){return"metadata="+JSON.stringify(e)},radius:function(e){return"r="+e},categories:function(e){e=angular.isString(e)?[e]:e;return"categories="+encodeArrayToUriComponent(e)},includeMetadata:function(e){return"includemetadata="+e},pageSize:function(e){if(e<1||e>100){throw new Error("PageSize can not be less then 1 or greater than 100")}else{return"pagesize="+e}},offset:function(e){if(e<0){throw new Error("Offset can not be less then 0")}else{return"offset="+e}},relativeFindPercentThreshold:function(e){if(e<=0){throw new Error("Threshold can not be less then or equal 0")}else{return"relativeFindPercentThreshold="+e}},relativeFindMetadata:function(e){return"relativeFindMetadata="+JSON.stringify(e)},condition:function(e){return"whereClause="+encodeURIComponent(e)}},addPoint:function(r){if(r.latitude===undefined||r.longitude===undefined){throw"Latitude or longitude not a number"}r.categories=r.categories||["Default"];r.categories=angular.isArray(r.categories)?r.categories:[r.categories];var i="lat="+r.latitude;i+="&lon="+r.longitude;if(r.categories){i+="&categories="+encodeArrayToUriComponent(r.categories)}if(r.metadata){i+="&metadata="+JSON.stringify(r.metadata)}var s=e.appPath+"/geo/points?"+i,o=t.defer();n({url:s,method:"put",headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){o.resolve(e)}).error(function(e){o.resolve(e)});return o.promise},findUtil:function(r){var i=r["url"],s=t.defer(),o=true;if(r.searchRectangle&&r.radius){throw new Error("Inconsistent geo query. Query should not contain both rectangle and radius search parameters.")}else if(r.radius&&(r.latitude===undefined||r.longitude===undefined)){throw new Error("Latitude and longitude should be provided to search in radius")}else if((r.relativeFindMetadata||r.relativeFindPercentThreshold)&&!(r.relativeFindMetadata&&r.relativeFindPercentThreshold)){throw new Error("Inconsistent geo query. Query should contain both relativeFindPercentThreshold and relativeFindMetadata or none of them")}else{i+=r.searchRectangle?"/rect?":"/points?";i+="units="+(r.units?r.units:this.UNITS.KILOMETERS);for(var u in r){if(r.hasOwnProperty(u)&&this._findHelpers.hasOwnProperty(u)&&r[u]!=undefined){i+="&"+this._findHelpers[u](r[u])}}}i=i.replace(/\?&/g,"?");n.get(i,{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(e.collection)}).error(function(e){s.resolve(e)});return s.promise},find:function(t){t["url"]=e.appPath+"/geo";return this.findUtil(t)},relativeFind:function(t){if(!(t.relativeFindMetadata&&t.relativeFindPercentThreshold)){throw new Error("Inconsistent geo query. Query should contain both relativeFindPercentThreshold and relativeFindMetadata")}else{t["url"]=e.appPath+"/geo/relative";return this.findUtil(t)}},addCategory:function(r){if(!r){throw new Error("Category name is requred.")}var i=e.appPath+"/geo/categories/"+r,s=t.defer();n({url:i,method:"put",headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(e)}).error(function(e){defefered.resolve(e)});return s.promise},getCategories:function(){var r=e.appPath+"/geo/categories",i=t.defer();n.get(r,{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){i.resolve(e)}).error(function(e){i.resolve(e)});return i.promise},deleteCategory:function(r){if(!r){throw new Error("Category name is required.")}var i=e.appPath+"/geo/categories/"+r,s=t.defer();n.delete(i,{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(e)}).error(function(e){s.resolve(e)});return s.promise},deletePoint:function(r){if(!r||angular.isFunction(r)){throw new Error("Point argument name is required, must be string (object Id), or point object")}var i=angular.isString(r)?r:r.objectId,s=e.appPath+"/geo/points/"+i,o=t.defer();n.delete(s,{headers:{"application-id":e.appId,"secret-key":e.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){o.resolve(e)}).error(function(e){o.resolve(e)});return o.promise}};return new r});BackendlessAngular.factory("$Messaging",function(e,t,n){function i(){}function s(e){this.eventHandlers={};this.restUrl=e;this.timer=0;this.timeout=0;this.interval=1e3;this.xhr=null;this.needReconnect=true;this.responder=new o(this.onMessage,this.onError,this);this.poll()}function o(e,t,n){if(!(t instanceof Function)){n=t;t=emptyFn}this.success=function(t){e&&e.call(n,t)};this.fault=function(e){t&&t.call(n,e)}}function l(e){var t=this;this.channelName=e.channelName;this.options=e.options;e.channelProperties.then(function(e){t.channelProperties=e});this.subscriptionId=null;this.restUrl=e.restUrl+"/"+e.channelName;this.responder=e.responder||emptyFn;this._subscribe(e.onSubscribe)}function c(){this.channelProperties={}}var r=null;i.prototype={on:function(e,t){if(!e){throw new Error("Event name not specified")}if(!t){throw new Error("Handler not specified")}this.eventHandlers[e]=this.eventHandlers[e]||[];this.eventHandlers[e].push(t)},fireEvent:function(e,t){var n=this.eventHandlers[e]||[],r,i;for(i=0,r=n.length;i<r;++i){n[i](t)}}};var u=function(e){var t=new XMLHttpRequest,n;t.onreadystatechange=function(){if(t.readyState==4){if(t.status>=200&&t.status<300){n=a(t);e.asyncHandler.success&&e.asyncHandler.success(n)}else{e.asyncHandler.fault&&e.asyncHandler.fault(f(t))}}};t.open("GET",e.url,true);t.setRequestHeader("Content-Type","application/json");t.setRequestHeader("application-id",e._config.appId);t.setRequestHeader("secret-key",e._config.secretKey);t.setRequestHeader("application-type","JS");t.send(null)};var a=function(e){var t=true;if(e.responseText){try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}}return t};var f=function(e){var t={};try{t=JSON.parse(e.responseText)}catch(n){t.message=e.responseText}t.statusCode=e.status;t.message=t.message||"unknown error occurred";return t};s.prototype=new i;deepExtend(s.prototype,{onMessage:function(e){clearTimeout(this.timeout);var t=this;this.timer=setTimeout(function(){t.poll()},this.interval);this.fireEvent("messageReceived",e)},poll:function(){var e=this;this.timeout=setTimeout(function(){e.onTimeout()},30*1e3);this.xhr=u({url:this.restUrl,asyncHandler:this.responder,_config:t})},close:function(){clearTimeout(this.timer);clearTimeout(this.timeout);this.needReconnect=false;this.xhr&&this.xhr.abort()},onTimeout:function(){this.xhr&&this.xhr.abort()},onError:function(){clearTimeout(this.timer);clearTimeout(this.timeout);if(this.needReconnect){var e=this;this.xhr=null;this.timer=setTimeout(function(){e.poll()},this.interval)}}});l.prototype={_subscribe:function(){var r=this,i=e.defer(),s;n({url:this.restUrl+"/subscribe",method:"post",data:JSON.stringify(this.options),headers:{"application-id":t.appId,"secret-key":t.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s=e;r.subscriptionId=s.subscriptionId;r._startSubscription();i.resolve(e)}).error(function(e){i.resolve(e)})},_startSubscription:function(){var e=this;this._switchToPolling();this._startSubscription=emptyFn},cancelSubscription:function(){this.proxy&&this.proxy.close();this._startSubscription=emptyFn},_switchToPolling:function(){var e=this.restUrl+"/"+this.subscriptionId;this.proxy=new s(e);var t=this;this.proxy.on("messageReceived",function(e){if(e.messages.length)t.responder(e)})}};c.prototype={_getProperties:function(r){var i=this,s=e.defer(),o=this.channelProperties[r];if(o){return o}n.get(t.appPath+"/messaging/"+r+"/properties",{headers:{"application-id":t.appId,"secret-key":t.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){i.channelProperties[r]=e;s.resolve(e)}).error(function(e){s.resolve(e)});return s.promise},subscribe:function(e,n,r){var i=this._getProperties(e);return new l({channelName:e,options:r,channelProperties:i,responder:n,restUrl:t.appPath+"/messaging"})},publish:function(r,i,s,o){var u={message:i},a=this,f=e.defer();if(s){if(!(s instanceof PublishOptions))throw"Use PublishOption as publishOptions argument";deepExtend(u,s)}if(o){if(!(o instanceof DeliveryOptions))throw"Use DeliveryOptions as deliveryTarget argument";deepExtend(u,o)}n.post(t.appPath+"/messaging/"+r,u,{headers:{"application-id":t.appId,"secret-key":t.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){f.resolve(e)}).error(function(e){f.resolve(e)});return f.promise},sendEmail:function(r,i,s,o){var u=this,a=e.defer(),f={};if(r&&!isEmpty(r)&&angular.isString(r)){f.subject=r}else{throw"Subject is required parameter and must be a nonempty string"}if(i instanceof Bodyparts&&!isEmpty(i)){f.bodyparts=i}else{throw"Use Bodyparts as bodyParts argument, must contain at least one property"}if(s&&angular.isArray(s)&&!isEmpty(s)){f.to=s}else{throw"Recipients is required parameter, must be a nonempty array"}if(o){if(angular.isArray(o)){if(!isEmpty(o)){f.attachment=o}}else{throw"Attachments must be an array of file IDs from File Service"}}n.post(t.appPath+"/messaging/email",f,{headers:{"application-id":t.appId,"secret-key":t.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){a.resolve(e)}).error(function(e){a.resolve(e)});return a.promise},cancel:function(r){var i=this,s=e.defer();n.delete(t.appPath+"/messaging/"+r,{headers:{"application-id":t.appId,"secret-key":t.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(e)}).error(function(e){s.resolve(e)});return s.promise}};return new c});BackendlessAngular.factory("$Files",function(e,t,n){function r(e,t,n){var r="--",i="\r\n",s="";s+=r;s+=n;s+=i;s+='Content-Disposition: form-data; name="file"';s+='; filename="'+e+'"';s+=i;s+="Content-Type: application/octet-stream";s+=i;s+=i;s+=t;s+=i;s+=r;s+=n;s+=r;s+=i;return s}function i(){}i.prototype={_send:function(e){initXHR();var t=new XMLHttpRequest,i="-backendless-multipart-form-boundary-"+getNow(),s=r(this.fileName,e.target.result,i),o=function(e){var t={};try{t=JSON.parse(e.responseText)}catch(n){t.message=e.responseText}t.statusCode=e.status;return t};t.open("POST",this.uploadPath,true);t.setRequestHeader("content-type","multipart/form-data; boundary="+i);t.setRequestHeader("application-id",n.appId);t.setRequestHeader("secret-key",n.secretKey);t.setRequestHeader("application-type","JS");if(UIState!==null){t.setRequestHeader("uiState",UIState)}var u=this.asyncHandler;if(u)t.onreadystatechange=function(){if(t.readyState==4){if(t.status>=200&&t.status<300){u.success(JSON.parse(t.responseText))}else{u.fault(JSON.parse(t.responseText))}}};t.sendAsBinary(s);if(u){return t}if(t.status>=200&&t.status<300){return t.responseText?JSON.parse(t.responseText):true}else{throw o(t)}},upload:function(e,t,r){e=e.files||e;var i=n.appPath+"/files/"+t+"/";if(isBrowser()){if(window.File&&window.FileList){if(e instanceof File){e=[e]}var s=0,o=0;for(var u=0,a=e.length;u<a;u++){try{var f=new FileReader;f.fileName=e[u].name;f.uploadPath=i+f.fileName;f.onloadend=this._send;f.asyncHandler=r;f.onerror=function(e){r.fault(e)};f.readAsBinaryString(e[u])}catch(l){s++}}}else{var c=document.createElement("iframe");c.id=c.name="ifr"+getNow();c.width=c.height="0";document.body.appendChild(c);var h=document.createElement("form");h.target=c.name;h.enctype="multipart/form-data";h.method="POST";document.body.appendChild(h);h.appendChild(e);var p=e.value,d=p.lastIndexOf("\\");if(d){p=p.substring(d+1)}h.action=i+p;h.submit()}}else{throw"Upload File not supported with NodeJS"}},remove:function(r){var i=r.indexOf("http://")==0||r.indexOf("https://")==0?r:n.appPath+"/files/"+r;var s=e.defer();t({url:i,method:"delete",headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(e)}).error(function(e){s.resolve(e)});return s.promise},removeDirectory:function(r){var i=e.defer();t({url:n.appPath+"/files/"+r,method:"delete",headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){i.resolve(e)}).error(function(e){i.resolve(e)});return i.promise}};return new i});BackendlessAngular.factory("$Commerce",function(e,t,n){function r(){}r.prototype.validatePlayPurchase=function(r,i,s){if(arguments.length<3){throw new Error("Package Name, Product Id, Token must be provided and must be not an empty STRING!")}for(var o=arguments.length-2;o>=0;o--){if(!arguments[o]||!angular.isString(arguments[o])){throw new Error("Package Name, Product Id, Token must be provided and must be not an empty STRING!")}}var u=e.defer();t({url:n.appPath+"/commerce/googleplay/validate/"+r+"/inapp/"+i+"/purchases/"+s,method:"get",headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){u.resolve(e)}).error(function(e){u.resolve(e)});return u.promise};r.prototype.cancelPlaySubscription=function(r,i,s){if(arguments.length<3){throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!")}for(var o=arguments.length-2;o>=0;o--){if(!arguments[o]||!angular.isString(arguments[o])){throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!")}}var u=e.defer();t({url:n.appPath+"/commerce/googleplay/"+r+"/subscription/"+i+"/purchases/"+s+"/cancel",method:"post",headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){u.resolve(e)}).error(function(e){u.resolve(e)});return u.promise};r.prototype.getPlaySubscriptionStatus=function(r,i,s){if(arguments.length<3){throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!")}for(var o=arguments.length-2;o>=0;o--){if(!arguments[o]||!angular.isString(arguments[o])){throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!")}}var u=e.defer();t({url:n.appPath+"/commerce/googleplay/"+r+"/subscription/"+i+"/purchases/"+s,method:"post",headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){u.resolve(e)}).error(function(e){u.resolve(e)});return u.promise};return new r});BackendlessAngular.factory("$Events",function(e,t,n){function r(){}r.prototype.dispatch=function(r,i){if(!r||!angular.isString(r)){throw new Error("Event Name must be provided and must be not an empty STRING!")}i=angular.isObject(i)?i:{};var s=e.defer();t({url:n.appPath+"/servercode/events/"+r,method:"post",data:i,headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(e)}).error(function(e){s.resolve(e)});return s.promise};return new r});BackendlessAngular.factory("$Counters",function(e,t,n){var r=function(){},i=function(e){this.name=e};r.prototype={of:function(e){return new i(e)},getConstructor:function(){return this},counterNameValidation:function(e){if(!e)throw new Error('You must send some value as "counterName" argument in this method. The argument must contain only string values');if(!angular.isString(e))throw new Error('Invalid value for the "value" argument. The argument must contain only string values')},implementMethod:function(r,i){var s=e.defer();t({url:n.serverURL+"/"+n.appVersion+"/counters/"+this.name+i,method:r,headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(e)}).error(function(e){s.resolve(e)});return s.promise},incrementAndGet:function(e){this.counterNameValidation(e);return this.implementMethod("PUT","/increment/get")},getAndIncrement:function(e){this.counterNameValidation(e);return this.implementMethod("PUT","/get/increment")},decrementAndGet:function(e){this.counterNameValidation(e);return this.implementMethod("PUT","/decrement/get")},getAndDecrement:function(e){this.counterNameValidation(e);return this.implementMethod("PUT","/get/decrement")},reset:function(e){this.counterNameValidation(e);return this.implementMethod("PUT","/reset")},get:function(r){this.counterNameValidation(r);var i=e.defer();t({url:n.serverURL+"/"+n.appVersion+"/counters/"+this.name,method:"get",headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){i.resolve(e)}).error(function(e){i.resolve(e)});return i.promise},addAndGet:function(r,i){this.counterNameValidation(r);if(!i)throw new Error('You must send some value as "value" argument in this method. The argument must contain only numeric values');if(!angular.isNumber(i))throw new Error('Invalid value for the "value" argument. The argument must contain only numeric values');var s=e.defer();t({url:n.serverURL+"/"+n.appVersion+"/counters/"+this.name+"/incrementby/get?value="+(i?i:""),method:"put",headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(e)}).error(function(e){s.resolve(e)});return s.promise},getAndAdd:function(r,i){this.counterNameValidation(r);if(!i)throw new Error('You must send some value as "value" argument in this method. The argument must contain only numeric values');if(!angular.isNumber(i))throw new Error('Invalid value for the "value" argument. The argument must contain only numeric values');var s=e.defer();t({url:n.serverURL+"/"+n.appVersion+"/counters/"+this.name+"/get/incrementby?value="+(i?i:""),method:"put",headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){s.resolve(e)}).error(function(e){s.resolve(e)});return s.promise},compareAndSet:function(r,i,s){this.counterNameValidation(r);if(!i||!s)throw new Error('You must send some values as "expected" and "updated" arguments in this method. The arguments must contain only numeric values');if(!angular.isNumber(i)||!angular.isNumber(s))throw new Error('Invalid value for the "expected" or "updated" argument. The argument must contain only numeric values');var o=e.defer();t({url:n.serverURL+"/"+n.appVersion+"/counters/"+this.name+"/get/compareandset?expected="+(i&&s?i+"&updatedvalue="+s:""),method:"put",headers:{"application-id":n.appId,"secret-key":n.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){o.resolve(e)}).error(function(e){o.resolve(e)});return o.promise}};i.prototype={incrementAndGet:function(){return r.prototype.getConstructor().incrementAndGet(this.name)},getAndIncrement:function(){return r.prototype.getConstructor().getAndIncrement(this.name)},decrementAndGet:function(){return r.prototype.getConstructor().decrementAndGet(this.name)},getAndDecrement:function(){return r.prototype.getConstructor().getAndDecrement(this.name)},reset:function(){return r.prototype.getConstructor().reset(this.name)},get:function(){return r.prototype.getConstructor().get(this.name)},addAndGet:function(e){return r.prototype.getConstructor().addAndGet(this.name,e)},getAndAdd:function(e){return r.prototype.getConstructor().getAndAdd(this.name,e)},compareAndSet:function(e,t){return r.prototype.getConstructor().getAndAdd(this.name,e,t)}};return new r});BackendlessAngular.factory("$Cache",function($q,$http,$config){var Cache=function(){};var FactoryMethods=[];Cache.prototype={put:function(e,t,n){if(!angular.isString(e))throw new Error("You can use only String as key to put into Cache");if(n){if(typeof n!=("number"||"string")){throw new Error("You can use only String as timeToLive attribute to put into Cache")}}if(angular.isObject(t)&&t.constructor.name!="Object"){t.___class=!t.___class?t.constructor.name:t.___class}var r=$q.defer();$http({url:$config.serverURL+"/"+$config.appVersion+"/cache/"+e+(n?"?timeout="+n:""),method:"put",data:JSON.stringify(t),headers:{"application-id":$config.appId,"secret-key":$config.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){r.resolve(e)}).error(function(e){r.resolve(e)});return r.promise},expireIn:function(e,t){if(angular.isString(e)&&(angular.isNumber(t)||angular.isDate(t))&&t){t=angular.isDate(t)?t.getTime():t;var n=$q.defer();$http({url:$config.serverURL+"/"+$config.appVersion+"/cache/"+e+"/expireIn?timeout="+t,method:"put",data:{},headers:{"application-id":$config.appId,"secret-key":$config.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){n.resolve(e)}).error(function(e){n.resolve(e)});return n.promise}else{throw new Error('The "key" argument must be String. The "seconds" argument can be either Number or Date')}},expireAt:function(e,t){if(angular.isString(e)&&(angular.isNumber(t)||angular.isDate(t))&&t){t=angular.isDate(t)?t.getTime():t;var n=$q.defer();$http({url:$config.serverURL+"/"+$config.appVersion+"/cache/"+e+"/expireAt?timestamp="+t,method:"put",data:{},headers:{"application-id":$config.appId,"secret-key":$config.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){n.resolve(e)}).error(function(e){n.resolve(e)});return n.promise}else{throw new Error("You can use only String as key while expire in Cache. Second attribute must be declared and must be a Number or Date type")}},cacheMethod:function(e,t,n){if(!angular.isString(t))throw new Error('The "key" argument must be String');var r=$q.defer();$http({url:$config.serverURL+"/"+$config.appVersion+"/cache/"+t+(n?"/check":""),method:e,headers:{"application-id":$config.appId,"secret-key":$config.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(e){r.resolve(e)}).error(function(e){r.resolve(e)});return r.promise},contains:function(e){return this.cacheMethod("GET",e,true)},get:function(key){if(!angular.isString(key))throw new Error('The "key" argument must be String');var deffered=$q.defer();$http({url:$config.serverURL+"/"+$config.appVersion+"/cache/"+key,method:"get",headers:{"application-id":$config.appId,"secret-key":$config.secretKey,"application-type":"JS","Content-Type":"application/json"}}).success(function(data){if(angular.isObject(data)){if(data.___class){var object;try{var Object=eval(data.___class);object=new Object(data)}catch(e){try{object=new FactoryMethods[data.___class](data)}catch(e){object=data}}for(var key in data){object[key]=data[key]}deffered.resolve(object)}else{deffered.resolve(data)}}else{deffered.resolve(data)}}).error(function(e){deffered.resolve(e)});return deffered.promise},remove:function(e){return this.cacheMethod("DELETE",e,false)},setObjectFactory:function(e,t){FactoryMethods[e]=t}};return new Cache});BackendlessAngular.factory("$DataQuery",function(){function e(){this.properties=[];this.condition=null;this.options=null;this.url=null}e.prototype={addProperty:function(e){this.properties=this.properties||[];this.properties.push(e)}};return new e});BackendlessAngular.provider("Backendless",function(){return{$get:function(e,t,n,r,i,s,o,u,a,f,l,c,h){return{initApp:e,User:t,UserService:n,Persistence:r,GeoQuery:i,DataQuery:h,Geo:s,Messaging:o,Files:u,Commerce:a,Events:f,Counters:l,Cache:c}}}})})();var PublishOptionsHeaders={MESSAGE_TAG:"message",IOS_ALERT_TAG:"ios-alert",IOS_BADGE_TAG:"ios-badge",IOS_SOUND_TAG:"ios-sound",ANDROID_TICKER_TEXT_TAG:"android-ticker-text",ANDROID_CONTENT_TITLE_TAG:"android-content-title",ANDROID_CONTENT_TEXT_TAG:"android-content-text",ANDROID_ACTION_TAG:"android-action",WP_TYPE_TAG:"wp-type",WP_TITLE_TAG:"wp-title",WP_TOAST_SUBTITLE_TAG:"wp-subtitle",WP_TOAST_PARAMETER_TAG:"wp-parameter",WP_TILE_BACKGROUND_IMAGE:"wp-backgroundImage",WP_TILE_COUNT:"wp-count",WP_TILE_BACK_TITLE:"wp-backTitle",WP_TILE_BACK_BACKGROUND_IMAGE:"wp-backImage",WP_TILE_BACK_CONTENT:"wp-backContent",WP_RAW_DATA:"wp-raw"};var PublishOptions=function(e){e=e||{};this.publisherId=e.publisherId||undefined;this.headers=e.headers||undefined;this.subtopic=e.subtopic||undefined};var DeliveryOptions=function(e){e=e||{};this.pushPolicy=e.pushPolicy||undefined;this.pushBroadcast=e.pushBroadcast||undefined;this.pushSinglecast=e.pushSinglecast||undefined;this.publishAt=e.publishAt||undefined;this.repeatEvery=e.repeatEvery||undefined;this.repeatExpiresAt=e.repeatExpiresAt||undefined};var Bodyparts=function(e){e=e||{};this.textmessage=e.textmessage||undefined;this.htmlmessage=e.htmlmessage||undefined};var SubscriptionOptions=function(e){e=e||{};this.subscriberId=e.subscriberId||undefined;this.subtopic=e.subtopic||undefined;this.selector=e.selector||undefined}